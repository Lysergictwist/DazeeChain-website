<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find Animal Shelters - DazeeChain</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/common.css">
    <style>
        #map {
            height: 600px;
            width: 100%;
            border-radius: 0.5rem;
        }
        .search-box {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 107, 53, 0.2);
        }
        .shelter-card {
            background: rgba(17, 17, 17, 0.95);
            border: 1px solid #222;
            transition: all 0.3s ease;
        }
        .shelter-card:hover {
            border-color: #ff6b35;
            transform: translateY(-2px);
        }
    </style>
</head>
<body class="bg-black text-white">
    <!-- Navigation -->
    <nav class="bg-black border-b border-gray-800 shadow-lg fixed w-full z-50" style="top: 40px;">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center h-16">
                <a href="index.html" class="text-4xl sm:text-5xl font-bold gradient-text">DazeeChain</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="pt-32 pb-20">
        <div class="max-w-7xl mx-auto px-4">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Search Panel -->
                <div class="search-box p-6 rounded-lg">
                    <h2 class="text-2xl font-bold mb-6">Find Animal Shelters</h2>
                    
                    <!-- Search Input -->
                    <div class="mb-6">
                        <label class="block text-gray-300 mb-2">Location</label>
                        <div class="flex gap-2">
                            <input type="text" id="locationInput" placeholder="Enter zip code or city" 
                                   class="flex-1 px-4 py-2 rounded-lg bg-gray-900 border border-gray-700 focus:border-orange-500 focus:outline-none">
                            <button onclick="searchLocation()" 
                                    class="bg-orange-500 px-4 py-2 rounded-lg hover:bg-orange-600 transition">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Filters -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold mb-3">Filters</h3>
                        <div class="space-y-3">
                            <label class="flex items-center gap-2">
                                <input type="checkbox" class="form-checkbox text-orange-500 rounded">
                                <span>Open Now</span>
                            </label>
                            <label class="flex items-center gap-2">
                                <input type="checkbox" class="form-checkbox text-orange-500 rounded">
                                <span>Accepts DazeeCoin</span>
                            </label>
                            <label class="flex items-center gap-2">
                                <input type="checkbox" class="form-checkbox text-orange-500 rounded">
                                <span>Has Dogs</span>
                            </label>
                            <label class="flex items-center gap-2">
                                <input type="checkbox" class="form-checkbox text-orange-500 rounded">
                                <span>Has Cats</span>
                            </label>
                        </div>
                    </div>

                    <!-- Results List -->
                    <div id="resultsList" class="space-y-4">
                        <!-- Shelter cards will be inserted here -->
                    </div>
                </div>

                <!-- Map -->
                <div class="lg:col-span-2">
                    <div id="map" class="shadow-xl"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let map;
        let markers = [];
        let infoWindow;

        function initMap() {
            // Initialize the map centered on US
            map = new google.maps.Map(document.getElementById('map'), {
                center: { lat: 37.0902, lng: -95.7129 },
                zoom: 4,
                styles: [
                    // Dark theme map styles will go here
                ]
            });
            
            infoWindow = new google.maps.InfoWindow();
        }

        function searchLocation() {
            const input = document.getElementById('locationInput').value;
            const geocoder = new google.maps.Geocoder();
            
            geocoder.geocode({ address: input }, (results, status) => {
                if (status === 'OK') {
                    const location = results[0].geometry.location;
                    map.setCenter(location);
                    map.setZoom(11);
                    
                    // Search for shelters near this location
                    searchNearbyShelters(location);
                }
            });
        }

        function searchNearbyShelters(location) {
            const service = new google.maps.places.PlacesService(map);
            const request = {
                location: location,
                radius: '20000',
                keyword: 'animal shelter'
            };

            service.nearbySearch(request, (results, status) => {
                if (status === google.maps.places.PlacesServiceStatus.OK) {
                    clearMarkers();
                    results.forEach(place => {
                        createMarker(place);
                        addToResultsList(place);
                    });
                }
            });
        }

        function createMarker(place) {
            const marker = new google.maps.Marker({
                map: map,
                position: place.geometry.location,
                title: place.name,
                icon: {
                    url: 'images/shelter-marker.png',
                    scaledSize: new google.maps.Size(32, 32)
                }
            });

            markers.push(marker);

            marker.addListener('click', () => {
                const content = `
                    <div class="p-2">
                        <h3 class="font-bold">${place.name}</h3>
                        <p>${place.vicinity}</p>
                        <p>Rating: ${place.rating ? place.rating + '/5' : 'N/A'}</p>
                    </div>
                `;
                
                infoWindow.setContent(content);
                infoWindow.open(map, marker);
            });
        }

        function clearMarkers() {
            markers.forEach(marker => marker.setMap(null));
            markers = [];
            document.getElementById('resultsList').innerHTML = '';
        }

        function addToResultsList(place) {
            const resultsDiv = document.getElementById('resultsList');
            const card = document.createElement('div');
            card.className = 'shelter-card p-4 rounded-lg';
            card.innerHTML = `
                <h3 class="font-bold text-lg">${place.name}</h3>
                <p class="text-gray-400">${place.vicinity}</p>
                <div class="flex items-center mt-2">
                    <span class="text-orange-500">${place.rating ? '★'.repeat(Math.round(place.rating)) : ''}</span>
                    <span class="text-gray-600">${place.rating ? '☆'.repeat(5-Math.round(place.rating)) : 'No rating'}</span>
                    <span class="ml-2 text-sm text-gray-400">${place.user_ratings_total || 0} reviews</span>
                </div>
                <button onclick="map.setCenter(new google.maps.LatLng(${place.geometry.location.lat()}, ${place.geometry.location.lng()})); map.setZoom(15);"
                        class="mt-3 w-full bg-orange-500 px-4 py-2 rounded-lg hover:bg-orange-600 transition">
                    View on Map
                </button>
            `;
            resultsDiv.appendChild(card);
        }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places&callback=initMap" async defer></script>
</body>
</html>
